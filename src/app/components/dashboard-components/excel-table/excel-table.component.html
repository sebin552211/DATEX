<div class="modal">
  <div class="modal-content">
    <h2>Excel Data</h2>
    <div *ngIf="isLoading" class="loading">Saving data...</div>
    <div *ngIf="!isLoading && excelData.length === 0" class="no-data">No data available</div>
    <div *ngIf="errorMessage" class="error">{{ errorMessage }}</div>
    <div *ngIf="successMessage" class="success">{{ successMessage }}</div>
    <div class="table-container" *ngIf="!isLoading && excelData.length > 0">
      <table>
        <thead>
          <tr>
            <th *ngFor="let column of getColumnHeaders()">
              {{ column }}
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of excelData">
            <td *ngFor="let column of getColumnHeaders()">
              {{ row[column] }}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <input type="file" (change)="onFileChange($event)" accept=".xlsx, .xls" class="file-input" />
    <button (click)="saveData()" [disabled]="isLoading">Save Data</button>
    <button (click)="closeModal()">Close</button>
  </div>
</div>
